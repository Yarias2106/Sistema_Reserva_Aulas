{% extends 'BaseHeaderFooter.html' %}

 {% block title %}
    FormularioReserva
 {% endblock %}

{% block content %}
{% load static %}
<head>
  <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
  <script type="text/javascript">
    $(document).ready(function() {
        setTimeout(function() {
            $(".ventana").fadeOut(1500);
        },2000);
        });
  </script>



</head>
<script>
  function cambiar()
  {
  document.getElementById("alumno").value="";
  let test = document.getElementById("selector").value;
  const $select = document.getElementById("Grupi");
  const datos =  `{%for item in Tupla_Grupo%}{{item.Cod_Grupo}},{{item.Cod_Materia}}:{%endfor%}`;
  // const div = datos.split(':');
  let data = datos.split(':');
  const dataArr = new Set(data);
  let dividido = [...dataArr];

  for (let i = $select.options.length; i >= 0; i--) {
    $select.remove(i);
  }
  $select.innerHTML="<option disabled selected>Seleccione un Grupo</option>"
  for( i in dividido){
    if(dividido[i].includes(test)){
    const option = document.createElement('option');
    id_Grupo = dividido[i].split(",");
    
    const valor = id_Grupo[0]
    option.value = id_Grupo[0]
    option.text = id_Grupo[0]
    $select.appendChild(option);
    };
  }
  };
  function cambiado(){
    let MateriaSelect = document.getElementById("selector").value;
    let GrupoSelect = document.getElementById("Grupi").value;
    const datos =  "{%for item in Tupla_Grupo%}{{item.Cant_Inscritos}},{{item.Cod_Grupo}},{{item.Cod_Materia}}:{%endfor%}";
    const dividido = datos.split(':');

    for( i in dividido){
      if(dividido[i].includes(MateriaSelect) && dividido[i].includes(GrupoSelect)){
        const cantidad = dividido[i].split(",");
        document.getElementById("alumno").value=cantidad[0];
      };
  }
    
  };
  
</script>


<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"> -->

<link rel="stylesheet" href="{% static '/css/FormularioReserva.css' %}">

<section class="BodyFont mx-4">


  <div class="container formReserva col-md-7">


    <div class="form-group mt-3 col-md-12 col-lg-12 col-xl-12">
      <div>
      {% if messages %}
          <div class="ventana row ">
          <ul class="messages pe-xl-5 pe-lg-4 pe-md-4 pe-4">   
          {% for message in messages %}
              <center><li{% if message.tags %} class="alert alert-{{ message.tags }} alert-danger alert-dismissible fade show alertaCol"{% endif %} role="alert" >{{ message }}</li></center>
          {% endfor %}
          </ul>
          </div>
      {% endif %}
      </div>
    </div>  
    <form action="/validar/" method="POST" class="row g-3 p-4">
      {% csrf_token %} 
      <div class="col-md-9">
        <label for="inputState" class="form-label text-white">Materia:</label>
        <select id="selector" class="form-select" name="Materia" onchange=cambiar()>
          <option disabled selected>Selecione la Materia</option>
          {% for nombre in tuplita %}
          <option>{{nombre}}</option>
          {% endfor %}
        </select>
        
      </div>

      <div class="col-md-3">
        <label for="inputState" class="form-label text-white" >Grupo:</label>
        <select id="Grupi" class="form-select" name="Grupo" Value="" onchange=cambiado()>
          <option disabled selected>Seleccione un Grupo</option>

        </select>
      </div>

      <div class="col-md-3">
        <label for="input-label" class="form-label text-white">Cantidad de estudiantes </label>
        <input type="text" id="alumno" name="alumno" placeholder="NÂ° Estudiantes" class="form-control" readonly>
      </div>
    
    
      <div class="col-sm-3">
        <label for="input-label" class="form-label text-white">Fecha:</label>
        <input type="date" name="Fecha" id="Fecha" class="form-control" value="" min="" max="">
    </div>


   
      <div class="col-md-3">
        <label for="inputState" class="form-label text-white">Horario:</label>
        <select id="Horario" class="form-select" name="Horario">
          <option disabled selected>Seleccione el horario</option>
          <option>06:45</option>
          <option>08:15</option>
          <option>09:45</option><option>11:15</option><option>12:45</option>
          <option>14:15</option><option>15:45</option><option>17:15</option>
          <option>18:45</option><option>20:15</option>
        </select>
      </div>

      <div class="col-md-3">
        <label for="inputState" class="form-label text-white">Periodo:</label>
        <select id="Periodo" class="form-select" name="Periodo">
          <option disabled selected>Seleccione el periodo</option>
          <option>1</option>
          <option>2</option>
          
        </select>
      </div>

      <div class="mb-3">
        <label for="validationTextarea" class="form-label text-white">Motivo:</label>
        <textarea class="form-control" placeholder="Describa el motivo de su reserva" id="Motivo" name="Motivo" required></textarea>
        <div class="invalid-feedback">
          
        </div>
      </div>

      
      <div class="col-12">
        <center><button type="submit" class="btn btn-primary">Solicitar reserva</button></center>
      </div>
    </form>
  </div>
</section>

<script src="{% static '/js/fecha.js' %}"></script>

{% endblock %}

